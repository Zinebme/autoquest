<Window x:Class="autoquest.MainWindow" 
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
        xmlns:local="clr-namespace:autoquest" 
        mc:Ignorable="d" 
        Title="AutoQuest - Saisie MÃ©dicale Automatique"  
        Height="750" Width="1100" 
        MinHeight="600" MinWidth="1000" 
        WindowStartupLocation="CenterScreen" 
        ResizeMode="CanResizeWithGrip" 
        WindowStyle="SingleBorderWindow" 
        Background="#F3F4F6" 
        FontFamily="Segoe UI"> 
 
    <Window.Resources> 
        <!-- PALETTE DE COULEURS --> 
        <SolidColorBrush x:Key="PrimaryColor" Color="#2563EB"/> 
        <SolidColorBrush x:Key="SecondaryColor" Color="#1E293B"/> 
        <SolidColorBrush x:Key="AccentColor" Color="#10B981"/> 
        <SolidColorBrush x:Key="CardBackground" Color="White"/> 
        <SolidColorBrush x:Key="TextLight" Color="#6B7280"/> 
        <SolidColorBrush x:Key="BorderColor" Color="#E5E7EB"/> 
 
        <!-- STYLE DES BOUTONS PRINCIPAUX --> 
        <Style x:Key="PrimaryButton" TargetType="Button"> 
            <Setter Property="Background" Value="{StaticResource PrimaryColor}"/> 
            <Setter Property="Foreground" Value="White"/> 
            <Setter Property="Padding" Value="15,10"/> 
            <Setter Property="BorderThickness" Value="0"/> 
            <Setter Property="FontSize" Value="14"/> 
            <Setter Property="FontWeight" Value="SemiBold"/> 
            <Setter Property="Cursor" Value="Hand"/> 
            <Setter Property="Template"> 
                <Setter.Value> 
                    <ControlTemplate TargetType="Button"> 
                        <Border Background="{TemplateBinding Background}" CornerRadius="6" Padding="{TemplateBinding Padding}"> 
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/> 
                        </Border> 
                        <ControlTemplate.Triggers> 
                            <Trigger Property="IsMouseOver" Value="True"> 
                                <Setter Property="Opacity" Value="0.9"/> 
                            </Trigger> 
                        </ControlTemplate.Triggers> 
                    </ControlTemplate> 
                </Setter.Value> 
            </Setter> 
        </Style> 
 
        <!-- STYLE DES BOUTONS SECONDAIRES --> 
        <Style x:Key="SecondaryButton" TargetType="Button" BasedOn="{StaticResource PrimaryButton}"> 
            <Setter Property="Background" Value="#E5E7EB"/> 
            <Setter Property="Foreground" Value="#1F2937"/> 
        </Style> 
 
        <!-- STYLE DES CARTES --> 
        <Style x:Key="CardStyle" TargetType="Border"> 
            <Setter Property="Background" Value="{StaticResource CardBackground}"/> 
            <Setter Property="CornerRadius" Value="8"/> 
            <Setter Property="Padding" Value="15"/> 
            <Setter Property="BorderBrush" Value="{StaticResource BorderColor}"/> 
            <Setter Property="BorderThickness" Value="1"/> 
            <Setter Property="Effect"> 
                <Setter.Value> 
                    <DropShadowEffect Color="#000000" Opacity="0.05" BlurRadius="8" ShadowDepth="2"/> 
                </Setter.Value> 
            </Setter> 
        </Style> 
 
        <!-- STYLE POUR LES CHECKBOX --> 
        <Style x:Key="FileCheckBox" TargetType="CheckBox"> 
            <Setter Property="Margin" Value="5,2"/> 
            <Setter Property="FontSize" Value="13"/> 
        </Style> 
    </Window.Resources> 
 
    <Grid> 
        <Grid.RowDefinitions> 
            <RowDefinition Height="Auto"/> 
            <RowDefinition Height="*"/> 
            <RowDefinition Height="30"/> 
        </Grid.RowDefinitions> 
 
        <!-- ==================== MENU PRINCIPAL ==================== --> 
        <Menu Grid.Row="0" Background="White" Padding="5" Height="30"> 
            <MenuItem x:Name="FileMenu" Header="Fichier"> 
                <MenuItem x:Name="NewProjectMenuItem" Header="Nouveau projet" Click="NouveauProjet_Click" InputGestureText="Ctrl+N"/> 
                <MenuItem x:Name="OpenProjectMenuItem" Header="Ouvrir un projet" Click="OuvrirProjet_Click" InputGestureText="Ctrl+O"/> 
                <Separator/> 
                <MenuItem x:Name="SaveMenuItem" Header="Sauvegarder" Click="Sauvegarder_Click" InputGestureText="Ctrl+S"/> 
                <MenuItem x:Name="SaveAsMenuItem" Header="Sauvegarder sous..." Click="SauvegarderSous_Click"/> 
                <Separator/> 
                <MenuItem x:Name="ExportMenu" Header="Exporter"> 
                    <MenuItem x:Name="ExportExcelMenuItem" Header="Excel" Click="ExportExcelButton_Click"/> 
                    <MenuItem x:Name="ExportCsvMenuItem" Header="CSV" Click="ExportCsvButton_Click"/> 
                </MenuItem> 
                <Separator/> 
                <MenuItem x:Name="QuitMenuItem" Header="Quitter" Click="Quitter_Click" InputGestureText="Ctrl+Q"/> 
            </MenuItem> 
            <MenuItem x:Name="EditMenu" Header="Ã‰dition"> 
                <MenuItem x:Name="CopyMenuItem" Header="Copier" InputGestureText="Ctrl+C"/> 
                <MenuItem x:Name="PasteMenuItem" Header="Coller" InputGestureText="Ctrl+V"/> 
                <Separator/> 
                <MenuItem x:Name="DeleteMenuItem" Header="Supprimer" Click="DeleteSelected_Click" InputGestureText="Suppr"/> 
                <MenuItem x:Name="SelectAllMenuItem" Header="Tout sÃ©lectionner" Click="SelectAll_Click" InputGestureText="Ctrl+A"/> 
            </MenuItem> 
            <MenuItem x:Name="ViewMenu" Header="Affichage"> 
                <MenuItem x:Name="DarkModeMenuItem" Header="Mode sombre" IsCheckable="True" Click="ModeSombre_Click"/> 
                <Separator/> 
                <MenuItem x:Name="ZoomInMenuItem" Header="Zoom avant" InputGestureText="Ctrl++"/> 
                <MenuItem x:Name="ZoomOutMenuItem" Header="Zoom arriÃ¨re" InputGestureText="Ctrl+-"/> 
            </MenuItem> 
            <MenuItem x:Name="LanguageMenu" Header="Langue"> 
                <MenuItem x:Name="MenuEnglish" Header="English" Click="MenuEnglish_Click"/> 
                <MenuItem x:Name="MenuFrench" Header="FranÃ§ais" Click="MenuFrench_Click"/> 
            </MenuItem> 
            <MenuItem x:Name="HelpMenu" Header="Aide"> 
                <MenuItem x:Name="DocumentationMenuItem" Header="Documentation" Click="Documentation_Click"/> 
                <Separator/> 
                <MenuItem x:Name="AboutMenuItem" Header="Ã€ propos" Click="APropos_Click"/> 
            </MenuItem> 
        </Menu> 
 
        <!-- ==================== ONGLETS ==================== --> 
        <TabControl Grid.Row="1" Margin="10" Background="Transparent" BorderThickness="0"> 
 
            <!-- ===== ONGLET 1 : TABLEAU DE BORD ===== --> 
            <TabItem x:Name="HomeTab" Header="ðŸ“Š Tableau de bord"> 
                <Grid Margin="10"> 
                    <Grid.RowDefinitions> 
                        <RowDefinition Height="Auto"/> 
                        <RowDefinition Height="Auto"/> 
                        <RowDefinition Height="*"/> 
                    </Grid.RowDefinitions> 
 
                    <Border Grid.Row="0" Style="{StaticResource CardStyle}" Margin="0,0,0,15"> 
                        <StackPanel> 
                            <TextBlock x:Name="ProjectInfoTitle" Text="Projet en cours" FontSize="18" FontWeight="Bold" Margin="0,0,0,10"/> 
                            <Grid> 
                                <Grid.ColumnDefinitions> 
                                    <ColumnDefinition Width="Auto"/> 
                                    <ColumnDefinition Width="*"/> 
                                    <ColumnDefinition Width="Auto"/> 
                                    <ColumnDefinition Width="*"/> 
                                </Grid.ColumnDefinitions> 
                                <Grid.RowDefinitions> 
                                    <RowDefinition Height="Auto"/> 
                                    <RowDefinition Height="Auto"/> 
                                    <RowDefinition Height="Auto"/> 
                                </Grid.RowDefinitions> 
                                <TextBlock Grid.Row="0" Grid.Column="0" Text="Nom :" FontWeight="Bold" Margin="0,0,10,5"/> 
                                <TextBlock Grid.Row="0" Grid.Column="1" x:Name="ProjectNameDisplay" Text="Sans titre" Margin="0,0,20,5"/> 
                                <TextBlock Grid.Row="0" Grid.Column="2" Text="CrÃ©Ã© le :" FontWeight="Bold" Margin="20,0,10,5"/> 
                                <TextBlock Grid.Row="0" Grid.Column="3" x:Name="ProjectDateDisplay" Text="-" Margin="0,0,0,5"/> 
                                <TextBlock Grid.Row="1" Grid.Column="0" Text="Dossier :" FontWeight="Bold" Margin="0,0,10,5"/> 
                                <TextBlock Grid.Row="1" Grid.Column="1" x:Name="ProjectPathDisplay" Text="Non sauvegardÃ©" Margin="0,0,20,5" TextTrimming="CharacterEllipsis"/> 
                                <TextBlock Grid.Row="1" Grid.Column="2" Text="Statut :" FontWeight="Bold" Margin="20,0,10,5"/> 
                                <TextBlock Grid.Row="1" Grid.Column="3" x:Name="ProjectStatusDisplay" Text="-" Margin="0,0,0,5"/> 
                                <TextBlock Grid.Row="2" Grid.Column="0" Text="Fichiers :" FontWeight="Bold" Margin="0,0,10,5"/> 
                                <TextBlock Grid.Row="2" Grid.Column="1" x:Name="ProjectFilesDisplay" Text="0" Margin="0,0,20,5"/> 
                            </Grid> 
                            <ProgressBar x:Name="ProjectProgressBar" Height="8" Margin="0,15,0,0" Maximum="100" Value="0" Foreground="{StaticResource AccentColor}"/> 
                            <TextBlock x:Name="ProjectProgressText" Text="0/0 patients traitÃ©s" FontSize="12" Foreground="{StaticResource TextLight}" HorizontalAlignment="Right" Margin="0,5,0,0"/> 
                        </StackPanel> 
                    </Border> 
 
                    <Border Grid.Row="1" Style="{StaticResource CardStyle}" Margin="0,0,0,15"> 
                        <StackPanel> 
                            <TextBlock x:Name="QuickActionsTitle" Text="Actions rapides" FontSize="16" FontWeight="Bold" Margin="0,0,0,10"/> 
                            <UniformGrid Columns="3"> 
                                <Button x:Name="QuickNewProject" Content="Nouveau projet" Style="{StaticResource PrimaryButton}" Margin="5" Click="NouveauProjet_Click"/> 
                                <Button x:Name="QuickOpenProject" Content="Ouvrir projet" Style="{StaticResource SecondaryButton}" Margin="5" Click="OuvrirProjet_Click"/> 
                                <Button x:Name="QuickSaveProject" Content="Sauvegarder" Style="{StaticResource SecondaryButton}" Margin="5" Click="Sauvegarder_Click"/> 
                            </UniformGrid> 
                        </StackPanel> 
                    </Border> 
 
                    <Border Grid.Row="2" Style="{StaticResource CardStyle}"> 
                        <StackPanel> 
                            <TextBlock x:Name="StatsTitle" Text="Statistiques" FontSize="16" FontWeight="Bold" Margin="0,0,0,10"/> 
                            <Grid> 
                                <Grid.ColumnDefinitions> 
                                    <ColumnDefinition Width="*"/> 
                                    <ColumnDefinition Width="*"/> 
                                    <ColumnDefinition Width="*"/> 
                                </Grid.ColumnDefinitions> 
                                <StackPanel Grid.Column="0" HorizontalAlignment="Center"> 
                                    <TextBlock x:Name="StatsFilesLabel" Text="Fichiers chargÃ©s" Foreground="{StaticResource TextLight}"/> 
                                    <TextBlock x:Name="StatsFilesValue" Text="0" FontSize="32" FontWeight="Bold" Foreground="{StaticResource PrimaryColor}"/> 
                                </StackPanel> 
                                <StackPanel Grid.Column="1" HorizontalAlignment="Center"> 
                                    <TextBlock x:Name="StatsExtractionsLabel" Text="Extractions" Foreground="{StaticResource TextLight}"/> 
                                    <TextBlock x:Name="StatsExtractionsValue" Text="0" FontSize="32" FontWeight="Bold" Foreground="{StaticResource AccentColor}"/> 
                                </StackPanel> 
                                <StackPanel Grid.Column="2" HorizontalAlignment="Center"> 
                                    <TextBlock x:Name="StatsToVerifyLabel" Text="Ã€ vÃ©rifier" Foreground="{StaticResource TextLight}"/> 
                                    <TextBlock x:Name="StatsToVerifyValue" Text="0" FontSize="32" FontWeight="Bold" Foreground="#F59E0B"/> 
                                </StackPanel> 
                            </Grid> 
                        </StackPanel> 
                    </Border> 
                </Grid> 
            </TabItem> 
 
            <!-- ===== ONGLET 2 : CONFIGURATION ===== --> 
            <TabItem x:Name="ConfigTab" Header="âš™ï¸ Configuration"> 
                <Grid Margin="10"> 
                    <Grid.ColumnDefinitions> 
                        <ColumnDefinition Width="*"/> 
                        <ColumnDefinition Width="Auto"/> 
                        <ColumnDefinition Width="*"/> 
                    </Grid.ColumnDefinitions> 
 
                    <!-- Partie GAUCHE : Gestion des fichiers --> 
                    <Border Grid.Column="0" Style="{StaticResource CardStyle}" Margin="0,0,10,0"> 
                        <Grid> 
                            <Grid.RowDefinitions> 
                                <RowDefinition Height="Auto"/> 
                                <RowDefinition Height="Auto"/> 
                                <RowDefinition Height="Auto"/> 
                                <RowDefinition Height="*"/> 
                                <RowDefinition Height="Auto"/> 
                            </Grid.RowDefinitions> 
                            <TextBlock x:Name="FileManagerTitle" Grid.Row="0" Text="ðŸ“ Gestion des fichiers" FontSize="16" FontWeight="Bold" Margin="0,0,0,10"/> 
                             
                            <Border x:Name="DropZone" Grid.Row="1" 
                                    Background="#F8F9FA" BorderBrush="{StaticResource BorderColor}" 
                                    BorderThickness="2" CornerRadius="8" Padding="15" Margin="0,0,0,10" 
                                    AllowDrop="True" Drop="DropZone_Drop" DragEnter="DropZone_DragEnter" 
                                    MouseLeftButtonDown="DropZone_MouseLeftButtonDown" Cursor="Hand"> 
                                <StackPanel> 
                                    <TextBlock Text="ðŸ“¥" FontSize="32" HorizontalAlignment="Center"/> 
                                    <TextBlock x:Name="DropText" Text="Glissez-dÃ©posez vos fichiers (Image, PDF)" HorizontalAlignment="Center" FontWeight="Bold" Margin="0,5"/> 
                                    <TextBlock Text="ou cliquez pour parcourir" HorizontalAlignment="Center" FontSize="12" Foreground="{StaticResource TextLight}"/> 
                                </StackPanel> 
                            </Border> 
 
                            <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,0,0,5"> 
                                <CheckBox x:Name="SelectAllCheckBox" Content="Tout sÃ©lectionner" VerticalAlignment="Center" Margin="0,0,10,0" Click="SelectAllCheckBox_Click"/> 
                                <Button x:Name="DeleteSelectedButton" Content="ðŸ—‘ï¸ Supprimer" Style="{StaticResource SecondaryButton}" Padding="10,5" FontSize="12" Click="DeleteSelected_Click"/> 
                            </StackPanel> 
 
                            <ListBox x:Name="FilesListBox" Grid.Row="3" BorderThickness="1" BorderBrush="{StaticResource BorderColor}" Margin="0,5"> 
                                <ListBox.ItemTemplate> 
                                    <DataTemplate> 
                                        <CheckBox Content="{Binding FileName}" IsChecked="{Binding IsSelected}" Margin="2" Style="{StaticResource FileCheckBox}"/> 
                                    </DataTemplate> 
                                </ListBox.ItemTemplate> 
                            </ListBox> 
                             
                            <TextBlock x:Name="TotalFilesText" Grid.Row="4" Text="0 fichiers chargÃ©s" FontSize="12" Foreground="{StaticResource TextLight}" Margin="0,5,0,0"/> 
                        </Grid> 
                    </Border> 
 
                    <GridSplitter Grid.Column="1" Width="4" Background="Transparent" HorizontalAlignment="Center"/> 
 
                    <!-- Partie DROITE : Variables et ParamÃ¨tres --> 
                    <Border Grid.Column="2" Style="{StaticResource CardStyle}" Margin="10,0,0,0"> 
                        <Grid> 
                            <Grid.RowDefinitions> 
                                <RowDefinition Height="Auto"/> 
                                <RowDefinition Height="Auto"/> 
                                <RowDefinition Height="*"/> 
                                <RowDefinition Height="Auto"/> 
                            </Grid.RowDefinitions> 
 
                            <TextBlock x:Name="ConfigTitle" Grid.Row="0" Text="ðŸ“‹ Variables Ã  extraire" FontSize="16" FontWeight="Bold" Margin="0,0,0,10"/> 
 
                            <Grid Grid.Row="1" Margin="0,0,0,10"> 
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions> 
                                    <ColumnDefinition Width="*"/> 
                                    <ColumnDefinition Width="Auto"/> 
                                </Grid.ColumnDefinitions> 

                                <!-- Ajout individuel -->
                                <TextBox x:Name="NewVariableTextBox" Grid.Row="0" Grid.Column="0" Padding="8" BorderThickness="1" BorderBrush="{StaticResource BorderColor}" Margin="0,0,5,5"/>
                                <Button x:Name="AddVariableManuallyButton" Grid.Row="0" Grid.Column="1" Content="âž• Ajouter" Style="{StaticResource PrimaryButton}" Padding="15,8" Margin="0,0,0,5" Click="AddVariableManually_Click"/>

                                <!-- Ajout en masse -->
                                <TextBox x:Name="BulkVariablesTextBox" Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2"
                                         Height="80" Margin="0,5,0,5" Padding="8" AcceptsReturn="True"
                                         VerticalScrollBarVisibility="Auto" BorderThickness="1" BorderBrush="{StaticResource BorderColor}"/>
                                <Button x:Name="BulkAddVariablesButton" Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="2"
                                        Content="ðŸ“¥ Ajouter plusieurs (une par ligne)" Style="{StaticResource SecondaryButton}"
                                        Padding="10,5" Margin="0,0,0,10" Click="BulkAddVariables_Click"/>
                            </Grid> 
 
                            <ListBox x:Name="VariablesListBox" Grid.Row="2" BorderThickness="1" BorderBrush="{StaticResource BorderColor}"
                                     AllowDrop="True" PreviewMouseLeftButtonDown="VariablesListBox_PreviewMouseLeftButtonDown"
                                     MouseMove="VariablesListBox_MouseMove" Drop="VariablesListBox_Drop">
                                <ListBox.ItemTemplate> 
                                    <DataTemplate> 
                                        <Grid Margin="5"> 
                                            <Grid.ColumnDefinitions> 
                                                <ColumnDefinition Width="*"/> 
                                                <ColumnDefinition Width="Auto"/> 
                                            </Grid.ColumnDefinitions> 
                                            <TextBlock Text="{Binding}" VerticalAlignment="Center" FontWeight="SemiBold"/> 
                                            <Button Grid.Column="1" Content="âŒ" Background="Transparent" BorderThickness="0" Margin="5,0" Tag="{Binding}" Click="DeleteVariable_Click" Cursor="Hand"/>
                                        </Grid> 
                                    </DataTemplate> 
                                </ListBox.ItemTemplate> 
                            </ListBox> 
 
                            <StackPanel Grid.Row="3" Margin="0,15,0,0"> 
                                <Separator Margin="0,0,0,15"/> 
                                <TextBlock x:Name="PagesConfigTitle" Text="ðŸ“„ Organisation des pages" FontSize="14" FontWeight="Bold" Margin="0,0,0,10"/> 
                                <Grid> 
                                    <Grid.ColumnDefinitions> 
                                        <ColumnDefinition Width="*"/> 
                                        <ColumnDefinition Width="Auto"/> 
                                    </Grid.ColumnDefinitions> 
                                    <TextBlock Text="Nombre de pages par patient :" VerticalAlignment="Center"/> 
                                    <TextBox Grid.Column="1" x:Name="PagesPerPatientConfigTextBox" Text="1" Width="50" Padding="5" HorizontalContentAlignment="Center" TextChanged="PagesPerPatientTextBox_TextChanged"/> 
                                </Grid> 
                                <TextBlock x:Name="OrganizationText" Text="AperÃ§u : Patient 1 â†’ pages 1-1" Foreground="{StaticResource TextLight}" FontSize="12" Margin="0,5,0,0"/> 
                            </StackPanel> 
                        </Grid> 
                    </Border> 
                </Grid> 
            </TabItem> 
 
            <!-- ===== ONGLET 3 : TRAITEMENT & CONTRÃ”LE ===== --> 
            <TabItem x:Name="ExtractTab" Header="ðŸš€ Traitement &amp; ContrÃ´le"> 
                <Grid Margin="10"> 
                    <Grid.ColumnDefinitions> 
                        <ColumnDefinition Width="350"/> 
                        <ColumnDefinition Width="*"/> 
                    </Grid.ColumnDefinitions> 
 
                    <!-- Liste de navigation et statut --> 
                    <Border Grid.Column="0" Style="{StaticResource CardStyle}" Margin="0,0,10,0"> 
                        <Grid> 
                            <Grid.RowDefinitions> 
                                <RowDefinition Height="Auto"/> 
                                <RowDefinition Height="*"/> 
                                <RowDefinition Height="Auto"/> 
                            </Grid.RowDefinitions> 
 
                            <StackPanel Grid.Row="0" Margin="0,0,0,15"> 
                                <TextBlock Text="ðŸŽ¯ File d'attente" FontSize="16" FontWeight="Bold" Margin="0,0,0,10"/> 
                                <Button x:Name="ExtractButton" Content="ðŸš€ Lancer l'extraction du patient" Style="{StaticResource PrimaryButton}" Height="50" Click="ExtractButton_Click"/> 
                            </StackPanel> 
 
                            <ListBox x:Name="ControlListBox" Grid.Row="1" BorderThickness="1" BorderBrush="{StaticResource BorderColor}" SelectionChanged="ControlListBox_SelectionChanged"> 
                                <!-- Liste des patients ou Ã©lÃ©ments extraits --> 
                            </ListBox> 
 
                            <Grid Grid.Row="2" Margin="0,15,0,0"> 
                                <Grid.ColumnDefinitions> 
                                    <ColumnDefinition Width="*"/> 
                                    <ColumnDefinition Width="Auto"/> 
                                    <ColumnDefinition Width="*"/> 
                                </Grid.ColumnDefinitions> 
                                <Button x:Name="PrevButton" Grid.Column="0" Content="â—€ PrÃ©cÃ©dent" Style="{StaticResource SecondaryButton}" Click="PrevButton_Click"/> 
                                <TextBlock x:Name="PatientLabel" Grid.Column="1" Text="Patient 0 / 0" FontWeight="Bold" VerticalAlignment="Center" Margin="15,0"/> 
                                <Button x:Name="NextButton" Grid.Column="2" Content="Suivant â–¶" Style="{StaticResource SecondaryButton}" Click="NextButton_Click"/> 
                            </Grid> 
                        </Grid> 
                    </Border> 
 
                    <!-- Visualisation et Correction --> 
                    <Border Grid.Column="1" Style="{StaticResource CardStyle}"> 
                        <Grid> 
                            <Grid.RowDefinitions> 
                                <RowDefinition Height="Auto"/> 
                                <RowDefinition Height="2*"/> 
                                <RowDefinition Height="*"/> 
                            </Grid.RowDefinitions> 
 
                            <TextBlock x:Name="ControlViewTitle" Grid.Row="0" Text="ðŸ” VÃ©rification des donnÃ©es" FontSize="16" FontWeight="Bold" Margin="0,0,0,10"/> 
 
                            <Border Grid.Row="1" Background="#F9FAFB" BorderBrush="{StaticResource BorderColor}" BorderThickness="1" CornerRadius="4" Margin="0,0,0,10"> 
                                <Grid> 
                                    <ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto"> 
                                        <ItemsControl x:Name="MultiPagePreviewControl">
                                            <ItemsControl.ItemTemplate>
                                                <DataTemplate>
                                                    <Grid Margin="0,0,0,20">
                                                        <Image Source="{Binding ImageSource}" Stretch="Uniform"/>
                                                        <Canvas x:Name="AnnotationCanvas" Background="Transparent" Width="{Binding Width}" Height="{Binding Height}"/>
                                                    </Grid>
                                                </DataTemplate>
                                            </ItemsControl.ItemTemplate>
                                        </ItemsControl>
                                    </ScrollViewer> 
                                    <TextBlock x:Name="NoImageText" Text="Aucun visuel disponible" HorizontalAlignment="Center" VerticalAlignment="Center" Foreground="{StaticResource TextLight}"/> 
                                </Grid> 
                            </Border> 
 
                            <Border Grid.Row="2" BorderBrush="{StaticResource BorderColor}" BorderThickness="1" CornerRadius="4" Padding="10" Background="White"> 
                                <ScrollViewer VerticalScrollBarVisibility="Auto"> 
                                    <StackPanel x:Name="ControlDataPanel"> 
                                        <TextBlock Text="SÃ©lectionnez un patient pour voir les rÃ©sultats extraits" HorizontalAlignment="Center" Foreground="{StaticResource TextLight}" Margin="20"/> 
                                    </StackPanel> 
                                </ScrollViewer> 
                            </Border> 
                        </Grid> 
                    </Border> 
                </Grid> 
            </TabItem> 
 
            <!-- ===== ONGLET 4 : RÃ‰SULTATS ===== --> 
            <TabItem x:Name="ResultsTab" Header="ðŸ“‹ RÃ©sultats"> 
                <Grid Margin="10"> 
                    <Grid.RowDefinitions> 
                        <RowDefinition Height="Auto"/> 
                        <RowDefinition Height="*"/> 
                        <RowDefinition Height="Auto"/> 
                    </Grid.RowDefinitions> 
 
                    <Border Grid.Row="0" Style="{StaticResource CardStyle}" Margin="0,0,0,10"> 
                        <DockPanel> 
                            <StackPanel Orientation="Horizontal" DockPanel.Dock="Left"> 
                                <Grid Width="250" Margin="0,0,10,0"> 
                                    <TextBox x:Name="SearchTextBox" Padding="8,5" VerticalAlignment="Center" TextChanged="SearchTextBox_TextChanged"/> 
                                    <TextBlock x:Name="SearchPlaceholder" Text="ðŸ” Rechercher un patient..." Foreground="#9CA3AF" IsHitTestVisible="False" VerticalAlignment="Center" Margin="10,0"/> 
                                </Grid> 
                            </StackPanel> 
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right"> 
                                <Button x:Name="ExportExcelResultsButton" Content="ðŸ“Š Excel" Style="{StaticResource PrimaryButton}" Width="100" Margin="5" Click="ExportExcelButton_Click"/> 
                                <Button x:Name="ExportCsvResultsButton" Content="ðŸ“„ CSV" Style="{StaticResource SecondaryButton}" Width="100" Margin="5" Click="ExportCsvButton_Click"/> 
                                <Button x:Name="ClearResultsButton" Content="ðŸ”„ Effacer" Style="{StaticResource SecondaryButton}" Width="100" Margin="5" Click="EffacerResultats_Click"/> 
                            </StackPanel> 
                        </DockPanel> 
                    </Border> 
 
                    <DataGrid x:Name="ResultsDataGrid"  
                              Grid.Row="1"  
                              AutoGenerateColumns="True"  
                              IsReadOnly="True" 
                              GridLinesVisibility="Horizontal"  
                              Background="White"  
                              BorderBrush="{StaticResource BorderColor}"  
                              BorderThickness="1" 
                              Margin="0,0,0,10"/> 
 
                    <Border Grid.Row="2" Style="{StaticResource CardStyle}"> 
                        <UniformGrid Columns="3"> 
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center"> 
                                <TextBlock Text="ðŸ‘¥ Patients :" Foreground="{StaticResource TextLight}" Margin="0,0,5,0"/> 
                                <TextBlock x:Name="StatPatientsText" Text="0" FontWeight="Bold"/> 
                            </StackPanel> 
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center"> 
                                <TextBlock Text="ðŸ“„ Pages :" Foreground="{StaticResource TextLight}" Margin="0,0,5,0"/> 
                                <TextBlock x:Name="StatPagesText" Text="0" FontWeight="Bold"/> 
                            </StackPanel> 
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center"> 
                                <TextBlock Text="âœ… Extractions :" Foreground="{StaticResource TextLight}" Margin="0,0,5,0"/> 
                                <TextBlock x:Name="StatExtractionsText" Text="0" FontWeight="Bold"/> 
                            </StackPanel> 
                        </UniformGrid> 
                    </Border> 
                </Grid> 
            </TabItem> 
        </TabControl> 
 
        <!-- ==================== BARRE DE STATUT ==================== --> 
        <StatusBar Grid.Row="2" Background="{StaticResource SecondaryColor}" Padding="10,0"> 
            <StatusBarItem> 
                <TextBlock x:Name="StatusText" Text="PrÃªt" Foreground="White" FontSize="12"/> 
            </StatusBarItem> 
            <Separator Background="#374151"/> 
            <StatusBarItem HorizontalAlignment="Right"> 
                <StackPanel Orientation="Horizontal"> 
                    <TextBlock Text="Quota : " Foreground="#9CA3AF" FontSize="12"/> 
                    <TextBlock x:Name="QuotaStatusText" Text="-" Foreground="{StaticResource AccentColor}" FontSize="12" FontWeight="Bold"/> 
                </StackPanel> 
            </StatusBarItem> 
        </StatusBar> 
    </Grid> 
</Window>
